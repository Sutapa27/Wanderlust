<% layout("/layouts/boilerplate") %>
<link rel="stylesheet" href="/css/index.css">

<div
  class="modal fade"
  id="welcomeModal"
  tabindex="-1"
  aria-labelledby="welcomeModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered custom-modal">
    <div class="modal-content text-center p-4">
      <i class="fa-solid fa-compass modal-icon mb-3"></i>
      <h5 class="modal-title">Welcome to Wanderlust ✈️</h5>
      <p>Pack your bags and let's explore!</p>
      <button type="button" class="btn btn-dark mt-3" data-bs-dismiss="modal">
        Let's Go
      </button>
    </div>
  </div>
</div>

<div class="icon-tax">
  <div class="filter">
    <a href="/listings" class="text-decoration-none">
      <div class="nav-icons"><i class="fa-solid fa-border-all"></i></div>
      <p>All</p>
    </a>
  </div>
  <div id="filters">
    <div class="filter">
      <a href="/listings/category/trending" class="text-decoration-none">
        <div class="nav-icons"><i class="fa-solid fa-house-fire"></i></div>
        <p>Trending</p>
      </a>
    </div>
    <div class="filter">
      <a href="/listings/category/rooms" class="text-decoration-none">
        <div class="nav-icons"><i class="fa-solid fa-bed"></i></div>
        <p>Rooms</p>
      </a>
    </div>
    <div class="filter">
      <a href="/listings/category/iconic-cities" class="text-decoration-none">
        <div class="nav-icons"><i class="fa-solid fa-city"></i></div>
        <p>Iconic Cities</p>
      </a>
    </div>
    <div class="filter">
      <a href="/listings/category/mountains" class="text-decoration-none">
        <div class="nav-icons"><i class="fa-solid fa-mountain-sun"></i></div>
        <p>Mountains</p>
      </a>
    </div>
    <div class="filter">
      <a href="/listings/category/beach" class="text-decoration-none">
        <div class="nav-icons"><i class="fa-solid fa-umbrella-beach"></i></div>
        <p>Beach</p>
      </a>
    </div>
    <div class="filter">
      <a href="/listings/category/castles" class="text-decoration-none">
        <div class="nav-icons"><i class="fa-solid fa-chess-rook"></i></div>
        <p>Castles</p>
      </a>
    </div>
    <div class="filter">
      <a href="/listings/category/amazing-pools" class="text-decoration-none">
        <div class="nav-icons"><i class="fa-solid fa-person-swimming"></i></div>
        <p>Amazing Pools</p>
      </a>
    </div>
    <div class="filter">
      <a href="/listings/category/camping" class="text-decoration-none">
        <div class="nav-icons"><i class="fa-solid fa-campground"></i></div>
        <p>Camping</p>
      </a>
    </div>
    <div class="filter">
      <a href="/listings/category/farms" class="text-decoration-none">
        <div class="nav-icons"><i class="fa-solid fa-cow"></i></div>
        <p>Farms</p>
      </a>
    </div>
    <div class="filter">
      <a href="/listings/category/igloo" class="text-decoration-none">
        <div class="nav-icons"><i class="fa-solid fa-igloo"></i></div>
        <p>Igloo</p>
      </a>
    </div>
    <div class="filter">
      <a href="/listings/category/arctic" class="text-decoration-none">
        <div class="nav-icons"><i class="fa-solid fa-snowflake"></i></div>
        <p>Arctic</p>
      </a>
    </div>
    <div class="filter">
      <a href="/listings/category/play" class="text-decoration-none">
        <div class="nav-icons">
          <i class="fa-solid fa-table-tennis-paddle-ball"></i>
        </div>
        <p>Play</p>
      </a>
    </div>
    <div class="filter">
      <a href="/listings/category/dome" class="text-decoration-none">
        <div class="nav-icons"><i class="fa-solid fa-house"></i></div>
        <p>Dome</p>
      </a>
    </div>
    <div class="filter">
      <a href="/listings/category/house-boats" class="text-decoration-none">
        <div class="nav-icons"><i class="fa-solid fa-sailboat"></i></div>
        <p>House Boats</p>
      </a>
    </div>
  </div>
  <div class="tax-toggle border mt-3">
    <div class="form-check-reverse form-switch">
      <input
        class="form-check-input"
        type="checkbox"
        role="switch"
        id="switchCheckDefault"
      />
      <label class="form-check-label" for="switchCheckDefault"
        >Display total <br />
        after taxes</label
      >
    </div>
  </div>
</div>

<div class="row row-cols-lg-4 row-cols-md-3 row-cols-sm-2 row-cols-1 mt-3">
  <% for(let listing of allListings) { %>
  <a href="/listings/<%= listing._id %>" class="listing-link">
    <div class="card col listing-card">
      <% if(!currentUser || !currentUser._id.equals(listing.owner._id)) { %>
      <button
        class="wishlist-btn"
        data-listing-id="<%= listing._id %>"
        onclick="toggleWishlist(event, '<%= listing._id %>')"
      >
        <i class="fa-regular fa-heart"></i></button
      ><% } %>
      <img
        src="<%= listing.images && listing.images.length > 0 ? listing.images[0].url : '' %>"
        class="card-img-top"
        alt="listing_image"
        style="height: 20rem; object-fit: cover"
      />

      <div class="card-img-overlay"></div>
      <div class="card-body">
        <p class="card-text d-flex justify-content-between align-items-center">
          <b><%= listing.title %></b>
          <% if (listing.reviews && listing.reviews.length > 0) { %>
          <span class="text-dark ms-2" style="font-size: 0.8rem">
            <i class="fa-solid fa-star text-warning"></i>
            <%= listing.avgRating ? listing.avgRating : "0.0" %>
          </span>
          <% } %>
        </p>
        <p class="text-muted mb-1">
          <i class="bi bi-geo-alt-fill location-icon"></i>
          <%= listing.location %>, <%= listing.country %>
        </p>
        <p>
          &#8377;<span
            class="listing-price"
            data-base-price="<%= listing.price %>"
            ><%= listing.price.toLocaleString("en-IN") %></span
          >
          / night
          <span class="tax-info" style="display: none"
            >&nbsp; (incl. 18% tax)</span
          >
        </p>
      </div>
    </div>
  </a>
  <% } %>
</div>
</div>
<script src="/js/index.js"></script>